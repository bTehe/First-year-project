---
title: "First year project - Bird project"
output: html_document
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE} 
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```


```{r}
library(tidyverse)
data <- read.csv('Factors Affecting Extinction.csv')
data
```


# 1 
Plot 4 graphs with LM, LR, SM, SR with slopes and geom_point()

```{r}
library(patchwork)
L_data <- subset(data, Size == "L")
S_data <- subset(data, Size == "S")
LM <- subset(L_data, Status == "M")
LR <- subset(L_data, Status == "R")
SM <- subset(S_data, Status == "M")
SR <- subset(S_data, Status == "R")

p1 <- ggplot(LM,aes(Pairs, Time)) + geom_point() + ggtitle("Large Migrant") + ylab("Time in thousands [Y]") + xlab("") + theme(plot.title = element_text(hjust = 0.5)) + stat_smooth(method = "lm", level = 0)
p2 <- ggplot(LR,aes(Pairs, Time)) + geom_point() + ggtitle("Large Resident")+ ylab("")  + xlab("") + theme(plot.title = element_text(hjust = 0.5))+ stat_smooth(method = "lm",level = 0)
p3 <- ggplot(SM,aes(Pairs, Time)) + geom_point() + ggtitle("Small Migrant") + ylab("Time in thousands [Y]") + xlab("Nr. of Pairs") + theme(plot.title = element_text(hjust = 0.5)) + stat_smooth(method = "lm",level = 0)
p4 <- ggplot(SR,aes(Pairs, Time)) + geom_point() + ggtitle("Small Resident") + ylab("") + xlab("Nr. of Pairs") + theme(plot.title = element_text(hjust = 0.5)) + stat_smooth(method = "lm",level = 0)

p1 + p2 + p3 + p4




lm_data <- lm(formula = Time ~ Pairs + Size + Status + Pairs*Size + Pairs * Status + Size*Status + Pairs*Size*Status, data)
summary(lm_data)

```



# 2
Residual plot + plots of possible transformations

```{r}

standard_res <- rstandard(lm_data)
final_data <- cbind(data, standard_res)
plot(final_data$Pairs, standard_res, ylab='Standardized Residuals', xlab='Predicted values') 
abline(0, 0)


```


# 3
Try log(t), sqrt(t), 1/t
Which fits best?

# 4
Explain Outliers and argue why they should be in dataset

# 5 



